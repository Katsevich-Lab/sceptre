<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="sceptre">
<title>Import data • sceptre</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Import data">
<meta property="og:description" content="sceptre">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">sceptre</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.4</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/sceptre.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/assign-grnas.html">Assign gRNAs</a>
    <a class="dropdown-item" href="../articles/import-data.html">Import data</a>
    <a class="dropdown-item" href="../articles/run-calibration-check.html">Run calibration check</a>
    <a class="dropdown-item" href="../articles/run-qc.html">Run quality control</a>
    <a class="dropdown-item" href="../articles/set-analysis-parameters.html">Set analysis parameters</a>
    <a class="dropdown-item" href="../articles/troubleshooting-and-faq.html">Troubleshooting and frequently asked questions</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/Katsevich-Lab/sceptre/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Import data</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/Katsevich-Lab/sceptre/blob/HEAD/vignettes/import-data.Rmd" class="external-link"><code>vignettes/import-data.Rmd</code></a></small>
      <div class="d-none name"><code>import-data.Rmd</code></div>
    </div>

    
    
<p>This vignette describes how to import single-cell CRISPR screen data
into <code>sceptre</code>, which is the first step of the
<code>sceptre</code> pipeline.</p>
<p><img src="pipeline_schematic_step_1.png" width="650px" style="display: block; margin: auto;"></p>
<p>Users either can import data directly from the output of an existing
software package (e.g., 10X CellRanger or the Parse Biosciences count
matrix generation program) or from a specified set of R objects. We
recommend that users import data from the output of an existing software
package, as doing so decreases the probability of error. We begin by
loading the <code>sceptre</code> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/Katsevich-Lab/sceptre" class="external-link">sceptre</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="import-data-from-an-existing-software-package">Import data from an existing software package<a class="anchor" aria-label="anchor" href="#import-data-from-an-existing-software-package"></a>
</h2>
<p><code>sceptre</code> links up with two programs for upstream
processing of single-cell CRISPR screen data: 10X Cellranger and the
analogous software tool developed by Parse Biosciences. (We refer to the
latter program as the “Parse program.”) We describe how to import data
from each of these tools below.</p>
<div class="section level3">
<h3 id="import-from-10x-cellranger">Import from 10X CellRanger<a class="anchor" aria-label="anchor" href="#import-from-10x-cellranger"></a>
</h3>
<p>The Get Started vignette (<code><a href="../articles/sceptre.html">vignette("sceptre")</a></code>) describes
how to import data from 10X CellRanger. We include a minimal working
example here.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">directories</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, package <span class="op">=</span> <span class="st">"sceptre"</span><span class="op">)</span>, <span class="st">"/highmoi_example/gem_group_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">grna_target_data_frame_highmoi</span><span class="op">)</span></span>
<span><span class="va">sceptre_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_data_from_cellranger.html">import_data_from_cellranger</a></span><span class="op">(</span>directories <span class="op">=</span> <span class="va">directories</span>,</span>
<span>                                              moi <span class="op">=</span> <span class="st">"high"</span>,</span>
<span>                                              grna_target_data_frame <span class="op">=</span> <span class="va">grna_target_data_frame_highmoi</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="import-from-the-parse-program">Import from the Parse program<a class="anchor" aria-label="anchor" href="#import-from-the-parse-program"></a>
</h3>
<p>A function to import data from the Parse program is coming soon.</p>
</div>
<div class="section level3">
<h3 id="add-extra-covariates">Add extra covariates<a class="anchor" aria-label="anchor" href="#add-extra-covariates"></a>
</h3>
<p><code><a href="../reference/import_data_from_cellranger.html">import_data_from_cellranger()</a></code> and
<code>input_data_from_parse()</code> compute the covariates
<code>grna_n_nonzero</code>, <code>grna_n_umis</code>,
<code>response_n_nonzero</code>, <code>response_n_umis</code>,
<code>response_p_mito</code>, and <code>batch</code>. Users may wish to
supply additional covariates (e.g., cell cycle or cell type) to
<code>sceptre</code>. To do so, users can pass a data frame
<code>extra_covariates</code> containing additional covariates to
<code><a href="../reference/import_data_from_cellranger.html">import_data_from_cellranger()</a></code> or
<code>input_data_from_parse()</code>. Below, we simulate an additional
covariate <code>cell_type</code> and pass this covariate as an argument
to the data import function.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># simulate an extra covariate, namely cell type</span></span>
<span><span class="va">cell_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"type_"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">45919</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html" class="external-link">factor</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">extra_covariates</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>cell_type <span class="op">=</span> <span class="va">cell_type</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># import data, passing the the extra covariates as an argument</span></span>
<span><span class="va">sceptre_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_data_from_cellranger.html">import_data_from_cellranger</a></span><span class="op">(</span>directories <span class="op">=</span> <span class="va">directories</span>,</span>
<span>                                              moi <span class="op">=</span> <span class="st">"high"</span>,</span>
<span>                                              grna_target_data_frame <span class="op">=</span> <span class="va">grna_target_data_frame_highmoi</span>,</span>
<span>                                              extra_covariates <span class="op">=</span> <span class="va">extra_covariates</span><span class="op">)</span></span></code></pre></div>
<p>The additional covariate of <code>cell_type</code> is printed in the
“covariates” field when we evaluate <code>sceptre_object</code> in the
console.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sceptre_object</span></span></code></pre></div>
<pre><code><span><span class="co">## An object of class <span style="color: #0000BB;">sceptre_object</span>.</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## Attributes of the data:</span></span>
<span><span class="co">##  • <span style="color: #0000BB;">45919</span> cells</span></span>
<span><span class="co">##  • <span style="color: #0000BB;">526</span> responses</span></span>
<span><span class="co">##  • <span style="color: #0000BB;">High</span> multiplicity-of-infection </span></span>
<span><span class="co">##  • <span style="color: #0000BB;">70</span> targeting gRNAs (distributed across <span style="color: #0000BB;">35</span> targets) </span></span>
<span><span class="co">##  • <span style="color: #0000BB;">25</span> non-targeting gRNAs </span></span>
<span><span class="co">##  • <span style="color: #0000BB;">7</span> covariates (batch, cell_type, grna_n_nonzero, grna_n_umis, response_n_nonzero, response_n_umis, response_p_mito)</span></span></code></pre>
</div>
</div>
<div class="section level2">
<h2 id="import-data-from-a-collection-of-r-objects">Import data from a collection of R objects<a class="anchor" aria-label="anchor" href="#import-data-from-a-collection-of-r-objects"></a>
</h2>
<p>Users also can import data into <code>sceptre</code> from a specified
set of R objects. This data import strategy is most appropriate for
users employing less standard data preprocessing pipelines to generate
the response and gRNA count matrices. We use the high MOI-CRISPRi data
as a working example. We can obtain these data in R matrix and data
frame format as follows.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">highmoi_example_data</span><span class="op">)</span></span>
<span><span class="va">response_matrix</span> <span class="op">&lt;-</span> <span class="va">highmoi_example_data</span><span class="op">$</span><span class="va">response_matrix</span> <span class="co"># response matrix</span></span>
<span><span class="va">grna_matrix</span> <span class="op">&lt;-</span> <span class="va">highmoi_example_data</span><span class="op">$</span><span class="va">grna_matrix</span> <span class="co"># grna matrix</span></span>
<span><span class="va">extra_covariates</span> <span class="op">&lt;-</span> <span class="va">highmoi_example_data</span><span class="op">$</span><span class="va">extra_covariates</span> <span class="co"># batch information</span></span>
<span><span class="va">response_names</span> <span class="op">&lt;-</span> <span class="va">highmoi_example_data</span><span class="op">$</span><span class="va">gene_names</span> <span class="co"># response names</span></span>
<span><span class="va">grna_target_data_frame</span> <span class="op">&lt;-</span> <span class="va">grna_target_data_frame_highmoi</span> <span class="co"># gRNA target data frame</span></span></code></pre></div>
<p>We call the function <code><a href="../reference/import_data.html">import_data()</a></code> to import the data
from a collection of R objects. <code><a href="../reference/import_data.html">import_data()</a></code> takes several
arguments: <code>response_matrix</code>, <code>grna_matrix</code>,
<code>grna_target_data_frame</code>, <code>moi</code>,
<code>extra_covariates</code>, and <code>response_names</code>. The
following figure summarizes the main inputs to this function.</p>
<div class="figure" style="text-align: center">
<img src="input_pieces.png" alt="The main data objects involved in a single-cell CRISPR screen analysis: a response matrix, a gRNA matrix, a data frame of extra covariates (optional), and a gRNA target data frame." width="750px"><p class="caption">
The main data objects involved in a single-cell CRISPR screen analysis:
a response matrix, a gRNA matrix, a data frame of extra covariates
(optional), and a gRNA target data frame.
</p>
</div>
<p>We describe the inputs below.</p>
<ul>
<li>
<p><code>response_matrix</code> is the matrix of response UMI
counts. The responses should be in the rows and the cells in the
columns. The row names of the <code>response_matrix</code> should be the
response IDs. The first ten rows and columns of the example
<code>response_matrix</code> are as follows.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">response_matrix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## 10 x 10 sparse Matrix of class "dgTMatrix"</span></span>
<span><span class="co">##                                       </span></span>
<span><span class="co">## ENSG00000069275 4 6 10 9 4 13 8 8 10 8</span></span>
<span><span class="co">## ENSG00000117222 2 1  . 1 1  . . .  . 1</span></span>
<span><span class="co">## ENSG00000117266 . .  . . .  . . .  . .</span></span>
<span><span class="co">## ENSG00000117280 . .  . 1 .  . . .  . 1</span></span>
<span><span class="co">## ENSG00000133059 . .  . . .  1 . 2  . 1</span></span>
<span><span class="co">## ENSG00000133065 . .  . . .  . . 2  . 1</span></span>
<span><span class="co">## ENSG00000133069 . .  . . .  . . .  . .</span></span>
<span><span class="co">## ENSG00000158711 . .  . . .  . . 1  . .</span></span>
<span><span class="co">## ENSG00000158715 . .  . . .  . . .  . .</span></span>
<span><span class="co">## ENSG00000162873 . .  . . .  . . .  . .</span></span></code></pre>
</li>
<li>
<p><code>grna_matrix</code> is the matrix of gRNA UMI counts. The
gRNAs should be in the rows and the cells in the columns. The row names
of <code>grna_matrix</code> should be the gRNA IDs. The first ten rows
and columns of the example <code>grna_matrix</code> are as follows.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grna_matrix</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## 10 x 10 sparse Matrix of class "dgTMatrix"</span></span>
<span><span class="co">##                                  </span></span>
<span><span class="co">## grna_CCGGGCG . 8 . . .  . . . . .</span></span>
<span><span class="co">## grna_TGGCGGC . . . . .  . . . . .</span></span>
<span><span class="co">## grna_AAGGCCG . . . . .  . . . . .</span></span>
<span><span class="co">## grna_GACGCCG . . . . .  . . . . .</span></span>
<span><span class="co">## grna_CACACCC . . . . . 25 . . . .</span></span>
<span><span class="co">## grna_GCTCACA . . . . .  . . . . .</span></span>
<span><span class="co">## grna_CTCTGAG . . . . .  . . . . .</span></span>
<span><span class="co">## grna_GCGCCCG . . . . .  . . . . .</span></span>
<span><span class="co">## grna_GAGCGTG . . . . .  . . . . .</span></span>
<span><span class="co">## grna_GCTCTGC . . . . .  . . . . .</span></span></code></pre>
</li>
</ul>
<p><code>response_matrix</code> and <code>grna_matrix</code> should be
stored in one of the following formats: <code>matrix</code>,
<code>dgTMatrix</code>, <code>dgCMatrix</code>, or
<code>dgRMatrix</code>.</p>
<ul>
<li>
<p><code>grna_target_data_frame</code> is the data frame mapping
each gRNA to its target. The <code>grna_target_data_frame</code> that we
pass to <code><a href="../reference/import_data.html">import_data()</a></code> is exactly the same as the one that
we pass to <code><a href="../reference/import_data_from_cellranger.html">import_data_from_cellranger()</a></code>. See
<code><a href="../articles/sceptre.html">vignette("sceptre")</a></code> for more information about this
argument.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">grna_target_data_frame</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="fl">21</span><span class="op">:</span><span class="fl">24</span>, <span class="fl">80</span><span class="op">:</span><span class="fl">83</span><span class="op">)</span>,<span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##         grna_id      grna_target   chr     start       end</span></span>
<span><span class="co">## 1  grna_CCGGGCG  ENSG00000069482 chr11  68451943  68451958</span></span>
<span><span class="co">## 2  grna_TGGCGGC  ENSG00000069482 chr11  68451958  68451974</span></span>
<span><span class="co">## 3  grna_AAGGCCG  ENSG00000100316 chr22  39715775  39715790</span></span>
<span><span class="co">## 4  grna_GACGCCG  ENSG00000100316 chr22  39715790  39715806</span></span>
<span><span class="co">## 21 grna_TCTTGAC  candidate_enh_1  chr1 205720419 205720623</span></span>
<span><span class="co">## 22 grna_TGATCGC  candidate_enh_1  chr1 205720623 205720828</span></span>
<span><span class="co">## 23 grna_ATAGGAG candidate_enh_10 chr19  19475680  19475878</span></span>
<span><span class="co">## 24 grna_GCAGGCA candidate_enh_10 chr19  19475878  19476077</span></span>
<span><span class="co">## 80 grna_TATTCGT    non-targeting  &lt;NA&gt;        NA        NA</span></span>
<span><span class="co">## 81 grna_GACCTCC    non-targeting  &lt;NA&gt;        NA        NA</span></span>
<span><span class="co">## 82 grna_TTTCTCT    non-targeting  &lt;NA&gt;        NA        NA</span></span>
<span><span class="co">## 83 grna_AATGAGG    non-targeting  &lt;NA&gt;        NA        NA</span></span></code></pre>
</li>
<li>
<p><code>moi</code> is a string specifying the MOI of the dataset,
either “high” or “low”. This argument serves the same function as it
does in <code><a href="../reference/import_data_from_cellranger.html">import_data_from_cellranger()</a></code>. See
<code><a href="../articles/sceptre.html">vignette("sceptre")</a></code> for more information.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">moi</span> <span class="op">&lt;-</span> <span class="st">"high"</span></span></code></pre></div>
</li>
<li>
<p><code>extra_covariates</code> (optional) is a data frame
specifying cell-specific covariates beyond those that
<code>sceptre</code> can compute. <code><a href="../reference/import_data.html">import_data()</a></code> computes
the covariates <code>grna_n_nonzero</code>, <code>grna_n_umis</code>,
<code>response_n_nonzero</code>, <code>response_n_umis</code>, and
<code>response_p_mito</code>. <code><a href="../reference/import_data.html">import_data()</a></code> does
<em>not</em> compute <code>batch</code>, as <code><a href="../reference/import_data.html">import_data()</a></code>
does not have access to batch information. Thus, <code>batch</code> —
alongside any other relevant covariates, such as cell type — should be
included in the <code>extra_covariates</code> data frame.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">extra_covariates</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>, <span class="fl">30001</span><span class="op">:</span><span class="fl">30003</span><span class="op">)</span>,,drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">##       batch</span></span>
<span><span class="co">## 1        b1</span></span>
<span><span class="co">## 2        b1</span></span>
<span><span class="co">## 3        b1</span></span>
<span><span class="co">## 30001    b2</span></span>
<span><span class="co">## 30002    b2</span></span>
<span><span class="co">## 30003    b2</span></span></code></pre>
</li>
<li>
<p><code>response_names</code> (optional) is a vector of
human-readable response names. <code>response_names</code> is used to
determine which of the responses (if any) are mitochondrial genes for
the purpose of computing the <code>response_p_mito</code> covariate.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">response_names</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] "NUCKS1"  "RBBP5"   "CDK18"   "RAB29"   "DSTYK"   "SLC41A1"</span></span></code></pre>
</li>
</ul>
<p>We pass the arguments <code>response_matrix</code>,
<code>grna_matrix</code>, <code>grna_target_data_frame</code>,
<code>moi</code>, <code>extra_covariates</code>, and
<code>response_names</code> to <code><a href="../reference/import_data.html">import_data()</a></code>, which
initializes a <code>sceptre_object</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sceptre_object</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/import_data.html">import_data</a></span><span class="op">(</span>response_matrix <span class="op">=</span> <span class="va">response_matrix</span>,</span>
<span>                              grna_matrix <span class="op">=</span> <span class="va">grna_matrix</span>,</span>
<span>                              grna_target_data_frame <span class="op">=</span> <span class="va">grna_target_data_frame</span>,</span>
<span>                              moi <span class="op">=</span> <span class="va">moi</span>,</span>
<span>                              extra_covariates <span class="op">=</span> <span class="va">extra_covariates</span>,</span>
<span>                              response_names <span class="op">=</span> <span class="va">response_names</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Timothy Barry, Eugene Katsevich.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
